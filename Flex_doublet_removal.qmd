---
title: "Untitled"
format: html
---

# FLEX lung doublet removal using ScDblFinder

```{r}
library(anndataR)
library(SingleCellExperiment)
library(scDblFinder)
```



```{r}
adata <- read_h5ad("flex_adata_combined_pre_qc.h5ad", as = "SingleCellExperiment")
adata
```

```{r}
assay(adata, "counts") <- assay(adata, "X")
adata <- scDblFinder(adata, samples = "sample_id", dbr.sd = 1)
```

```{r}
doublet_score <- adata$scDblFinder.score
doublet_class <- adata$scDblFinder.class
```

```{r}
table(adata$scDblFinder.class, adata$sample_id)
```
```{r}
write_h5ad(adata, path ="flex_data_doublets_identified.h5ad")
```